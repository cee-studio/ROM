diff -b -w -c -r Rom24old/README.version Rom24/README.version
*** Rom24old/README.version	Thu Jul 18 02:04:31 1996
--- Rom24/README.version	Sat May 23 16:24:50 1998
***************
*** 1 ****
! ROM 2.4b4, July 18, 1996
--- 1 ----
! ROM 2.4b5, May 23, 1998
Common subdirectories: Rom24old/area and Rom24/area
Common subdirectories: Rom24old/doc and Rom24/doc
Common subdirectories: Rom24old/gods and Rom24/gods
Common subdirectories: Rom24old/log and Rom24/log
Common subdirectories: Rom24old/player and Rom24/player
Common subdirectories: Rom24old/src and Rom24/src
diff -b -w -c -r Rom24old/area/rom.are Rom24/area/rom.are
*** Rom24old/area/rom.are	Thu Jul 18 04:34:51 1996
--- Rom24/area/rom.are	Sat May 23 14:43:55 1998
***************
*** 81,88 ****
  and various other ROM muds were started, including Rivers of Mud under
  a new management (Zump's ROM), at rom.org 9000.
  
! Alander's current project is Athen, the sequel to the ROM code.
! It will be found at hypercube.org 6666, when it is opened.
  
  The following people contributed to the ROM flavor of the merc base code:
  
--- 81,88 ----
  and various other ROM muds were started, including Rivers of Mud under
  a new management (Zump's ROM), at rom.org 9000.
  
! Alander's current project is Athen, the sequel to the ROM code. It can
! be found on Rehobaom's Legacy, at hypercube.org 9000.
  
  The following people contributed to the ROM flavor of the merc base code:
  
***************
*** 110,132 ****
  Ideas and playtesting --
      Thousands of dedicated mudders around the world
  
  Beta testing --
!     Ken Blosser, Doug Araya, and Sherene Neil all helped with bug reports
      and suggestions, saving a lot of headaches
  
! New Thalos area was donated by Onivel of Jedi, who was also the originator
! of the ASCII flags used in the zone files
  
  ROM 2.4 was developed during my time with Moosehead mud, and the release
  shares many of the features I wrote while I was there.  Additional code
! was written by Seth Scott (enchant armor, the new poofin/poofout), and many
! contributions and ideas from the Merc list were used.  Portions of Rusty's
! code from Moosehead also remain.
  
  The new features of 2.4 were largely produced in bull sessions with
  Gabrielle Taylor and Brian Moore, without whom this release wouldn't
  have happened.  In particular, the new privacy code, furniture, and
! wiznet are largely the results of Gabrielle's ideas.
  
  Changes to the standard diku mob and object format, as well as the changes
  to Merc 2.1 source code, were done by Alander over many a late night of
--- 110,136 ----
  Ideas and playtesting --
      Thousands of dedicated mudders around the world
  
+ The New Thalos area was donated by Onivel of Jedi, who was also the originator
+ of the ASCII flags used in the zone files
+ 
  Beta testing --
!     Ken Blosser, Doug Araya, and Sherene Neil all helped with bugs reports
      and suggestions, saving a lot of headaches
  
! Bug reports --
!     Thanks to Shad Muegge, Jerome Despret, Phoenix, Will Hongach,
!     Erwin S. Andreasen and Adam Debus for help spotting bugs
  
  ROM 2.4 was developed during my time with Moosehead mud, and the release
  shares many of the features I wrote while I was there.  Additional code
! was written by Seth Scott (the new poofin/poofout), and many contributions
! and ideas from the Merc list were used.  Portions of Rusty's work on
! Moosehead also remain.
  
  The new features of 2.4 were largely produced in bull sessions with
  Gabrielle Taylor and Brian Moore, without whom this release wouldn't
  have happened.  In particular, the new privacy code, furniture, and
! wiznet are the results of Gabrielle's ideas.
  
  Changes to the standard diku mob and object format, as well as the changes
  to Merc 2.1 source code, were done by Alander over many a late night of
***************
*** 236,242 ****
                 Original DikuMUD by Hans Staerfeldt, Katja Nyboe,
                 Tom Madsen, Michael Seifert, and Sebastian Hammer
                 Based on MERC 2.1 code by Hatchet, Furey, and Kahn
!                ROM 2.4 copyright (c) 1993-1996 Russ Taylor
  
  By what name do you wish to be known? ~
   
--- 240,246 ----
                 Original DikuMUD by Hans Staerfeldt, Katja Nyboe,
                 Tom Madsen, Michael Seifert, and Sebastian Hammer
                 Based on MERC 2.1 code by Hatchet, Furey, and Kahn
!                ROM 2.4 copyright (c) 1993-1998 Russ Taylor
  
  By what name do you wish to be known? ~
   
diff -b -w -c -r Rom24old/doc/rom.credits Rom24/doc/rom.credits
*** Rom24old/doc/rom.credits	Thu Jul 18 04:35:16 1996
--- Rom24/doc/rom.credits	Sat May 23 14:42:18 1998
***************
*** 27,33 ****
  Ideas and playtesting --
      Thousands of dedicated mudders around the world
  
! New Thalos area was donated by Onivel of Jedi, who was also the originator
  of the ASCII flags used in the zone files
  
  Beta testing --
--- 27,33 ----
  Ideas and playtesting --
      Thousands of dedicated mudders around the world
  
! The New Thalos area was donated by Onivel of Jedi, who was also the originator
  of the ASCII flags used in the zone files
  
  Beta testing --
***************
*** 34,39 ****
--- 34,43 ----
      Ken Blosser, Doug Araya, and Sherene Neil all helped with bugs reports
      and suggestions, saving a lot of headaches
  
+ Bug reports --
+     Thanks to Shad Muegge, Jerome Despret, Phoenix, Will Hongach,
+     Erwin S. Andreasen and Adam Debus for help spotting bugs
+ 
  ROM 2.4 was developed during my time with Moosehead mud, and the release
  shares many of the features I wrote while I was there.  Additional code
  was written by Seth Scott (the new poofin/poofout), and many contributions
***************
*** 43,49 ****
  The new features of 2.4 were largely produced in bull sessions with
  Gabrielle Taylor and Brian Moore, without whom this release wouldn't
  have happened.  In particular, the new privacy code, furniture, and
! wiznet are largely the results of Gabrielle's ideas.
  
  Changes to the standard diku mob and object format, as well as the changes
  to Merc 2.1 source code, were done by Alander over many a late night of
--- 47,53 ----
  The new features of 2.4 were largely produced in bull sessions with
  Gabrielle Taylor and Brian Moore, without whom this release wouldn't
  have happened.  In particular, the new privacy code, furniture, and
! wiznet are the results of Gabrielle's ideas.
  
  Changes to the standard diku mob and object format, as well as the changes
  to Merc 2.1 source code, were done by Alander over many a late night of
Only in Rom24/src: Makefile.normal
Only in Rom24/src: Makefile.solaris
diff -b -w -c -r Rom24old/src/act_comm.c Rom24/src/act_comm.c
*** Rom24old/src/act_comm.c	Thu Jul 18 04:43:07 1996
--- Rom24/src/act_comm.c	Sat May 23 14:50:57 1998
***************
*** 16,25 ****
   **************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   **************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 298,303 ****
--- 298,304 ----
  	{
  	  send_to_char("The gods have revoked your channel priviliges.\n\r",ch);
  	  return;
+ 	}
  
  	REMOVE_BIT(ch->comm,COMM_NOAUCTION);
      }
***************
*** 319,325 ****
  		    ch,argument,d->character,TO_VICT,POS_DEAD);
   	}
        }
-     }
  }
  
  /* RT chat replaced with ROM gossip */
--- 320,325 ----
diff -b -w -c -r Rom24old/src/act_enter.c Rom24/src/act_enter.c
*** Rom24old/src/act_enter.c	Thu Jul 18 04:43:09 1996
--- Rom24/src/act_enter.c	Sat May 23 14:51:25 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@efn.org)				   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/act_info.c Rom24/src/act_info.c
*** Rom24old/src/act_info.c	Thu Jul 18 04:43:13 1996
--- Rom24/src/act_info.c	Sat May 23 15:27:00 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/act_move.c Rom24/src/act_move.c
*** Rom24old/src/act_move.c	Sat Sep 21 13:25:59 1996
--- Rom24/src/act_move.c	Sat May 23 15:27:01 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/act_obj.c Rom24/src/act_obj.c
*** Rom24old/src/act_obj.c	Sat Feb 22 10:52:46 1997
--- Rom24/src/act_obj.c	Sat May 23 15:27:04 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 837,843 ****
      int percent,skill;
  
      /* find out what */
!     if (argument == '\0')
      {
  	send_to_char("Envenom what item?\n\r",ch);
  	return;
--- 837,843 ----
      int percent,skill;
  
      /* find out what */
!     if (argument[0] == '\0')
      {
  	send_to_char("Envenom what item?\n\r",ch);
  	return;
***************
*** 2252,2259 ****
      {
  	int gold, silver;
  
! 	gold = victim->gold * number_range(1, ch->level) / 60;
! 	silver = victim->silver * number_range(1,ch->level) / 60;
  	if ( gold <= 0 && silver <= 0 )
  	{
  	    send_to_char( "You couldn't get any coins.\n\r", ch );
--- 2252,2259 ----
      {
  	int gold, silver;
  
! 	gold = victim->gold * number_range(1, ch->level) / MAX_LEVEL;
! 	silver = victim->silver * number_range(1,ch->level) / MAX_LEVEL;
  	if ( gold <= 0 && silver <= 0 )
  	{
  	    send_to_char( "You couldn't get any coins.\n\r", ch );
diff -b -w -c -r Rom24old/src/act_wiz.c Rom24/src/act_wiz.c
*** Rom24old/src/act_wiz.c	Thu Jul 18 04:43:26 1996
--- Rom24/src/act_wiz.c	Sat May 23 15:27:07 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 2676,2684 ****
  	return;
      }
  
!     if ( ( level = atoi( arg2 ) ) < 1 || level > 60 )
      {
! 	send_to_char( "Level must be 1 to 60.\n\r", ch );
  	return;
      }
  
--- 2676,2685 ----
  	return;
      }
  
!     if ( ( level = atoi( arg2 ) ) < 1 || level > MAX_LEVEL )
      {
! 	sprintf(buf,"Level must be 1 to %d.\n\r", MAX_LEVEL);
! 	send_to_char(buf, ch);
  	return;
      }
  
***************
*** 2740,2745 ****
--- 2741,2747 ----
  {
      char arg1[MAX_INPUT_LENGTH];
      char arg2[MAX_INPUT_LENGTH];
+     char buf[MAX_STRING_LENGTH];
      CHAR_DATA *victim;
      int level;
  
***************
*** 2758,2766 ****
  	return;
      }
  
!     if ( ( level = atoi( arg2 ) ) < 0 || level > 60 )
      {
! 	send_to_char( "Level must be 0 (reset) or 1 to 60.\n\r", ch );
  	return;
      }
  
--- 2760,2769 ----
  	return;
      }
  
!     if ( ( level = atoi( arg2 ) ) < 0 || level > MAX_LEVEL )
      {
! 	sprintf(buf, "Level must be 0 (reset) or 1 to %d.\n\r",MAX_LEVEL);
! 	send_to_char(buf, ch);
  	return;
      }
  
***************
*** 3514,3522 ****
  	    return;
  	}
  
! 	if ( value < 0 || value > 60 )
  	{
! 	    send_to_char( "Level range is 0 to 60.\n\r", ch );
  	    return;
  	}
  	victim->level = value;
--- 3517,3526 ----
  	    return;
  	}
  
! 	if ( value < 0 || value > MAX_LEVEL )
  	{
! 	    sprintf(buf, "Level range is 0 to %d.\n\r", MAX_LEVEL);
! 	    send_to_char(buf, ch);
  	    return;
  	}
  	victim->level = value;
diff -b -w -c -r Rom24old/src/alias.c Rom24/src/alias.c
*** Rom24old/src/alias.c	Thu Jul 18 04:43:29 1996
--- Rom24/src/alias.c	Sat May 23 15:27:09 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 81,95 ****
  		strcat(buf,ch->pcdata->alias_sub[alias]);
  		strcat(buf," ");
  		strcat(buf,point);
! 		break;
! 	    }
  	    if (strlen(buf) > MAX_INPUT_LENGTH)
  	    {
! 		send_to_char("Alias substitution too long. Truncated.\r\n",ch);
  		buf[MAX_INPUT_LENGTH -1] = '\0';
  	    }
  	}
      }
      interpret(d->character,buf);
  }
  
--- 81,97 ----
  		strcat(buf,ch->pcdata->alias_sub[alias]);
  		strcat(buf," ");
  		strcat(buf,point);
! 
  	        if (strlen(buf) > MAX_INPUT_LENGTH)
  	        {
! 		    send_to_char(
! 			"Alias substitution too long. Truncated.\r\n",ch);
  		    buf[MAX_INPUT_LENGTH -1] = '\0';
  	        }
+ 		break;
  	    }
  	}
+     }
      interpret(d->character,buf);
  }
  
***************
*** 220,226 ****
   
      argument = one_argument(argument,arg);
  
!     if (arg == '\0')
      {
  	send_to_char("Unalias what?\n\r",ch);
  	return;
--- 222,228 ----
   
      argument = one_argument(argument,arg);
  
!     if (arg[0] == '\0')
      {
  	send_to_char("Unalias what?\n\r",ch);
  	return;
diff -b -w -c -r Rom24old/src/ban.c Rom24/src/ban.c
*** Rom24old/src/ban.c	Thu Jul 18 04:43:32 1996
--- Rom24/src/ban.c	Sat May 23 15:27:09 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/comm.c Rom24/src/comm.c
*** Rom24old/src/comm.c	Fri Jul 19 16:57:51 1996
--- Rom24/src/comm.c	Sat May 23 15:27:12 1998
***************
*** 19,28 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 19,28 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 257,267 ****
  int	close		args( ( int fd ) );
  int	getpeername	args( ( int s, struct sockaddr *name, int *namelen ) );
  int	getsockname	args( ( int s, struct sockaddr *name, int *namelen ) );
- int	gettimeofday	args( ( struct timeval *tp, struct timezone *tzp ) );
  int	listen		args( ( int s, int backlog ) );
  int	read		args( ( int fd, char *buf, int nbyte ) );
  int	select		args( ( int width, fd_set *readfds, fd_set *writefds,
  			    fd_set *exceptfds, struct timeval *timeout ) );
  #if defined(SYSV)
  int setsockopt		args( ( int s, int level, int optname,
  			    const char *optval, int optlen ) );
--- 257,270 ----
  int	close		args( ( int fd ) );
  int	getpeername	args( ( int s, struct sockaddr *name, int *namelen ) );
  int	getsockname	args( ( int s, struct sockaddr *name, int *namelen ) );
  int	listen		args( ( int s, int backlog ) );
  int	read		args( ( int fd, char *buf, int nbyte ) );
  int	select		args( ( int width, fd_set *readfds, fd_set *writefds,
  			    fd_set *exceptfds, struct timeval *timeout ) );
+ 
+ #if !defined(__SVR4)
+ int	gettimeofday	args( ( struct timeval *tp, struct timezone *tzp ) );
+ 
  #if defined(SYSV)
  int setsockopt		args( ( int s, int level, int optname,
  			    const char *optval, int optlen ) );
***************
*** 269,274 ****
--- 272,278 ----
  int	setsockopt	args( ( int s, int level, int optname, void *optval,
  			    int optlen ) );
  #endif
+ #endif
  int	socket		args( ( int domain, int type, int protocol ) );
  int	write		args( ( int fd, char *buf, int nbyte ) );
  #endif
***************
*** 1498,1504 ****
      /*
       * Copy.
       */
!     strcpy( d->outbuf + d->outtop, txt );
      d->outtop += length;
      return;
  }
--- 1502,1508 ----
      /*
       * Copy.
       */
!     strncpy( d->outbuf + d->outtop, txt, length );
      d->outtop += length;
      return;
  }
***************
*** 2002,2009 ****
--- 2006,2029 ----
  
      case CON_GEN_GROUPS:
  	send_to_char("\n\r",ch);
+ 
         	if (!str_cmp(argument,"done"))
         	{
+ 	    if (ch->pcdata->points == pc_race_table[ch->race].points)
+ 	    {
+ 	        send_to_char("You didn't pick anything.\n\r",ch);
+ 		break;
+ 	    }
+ 
+ 	    if (ch->pcdata->points <= 40 + pc_race_table[ch->race].points)
+ 	    {
+ 		sprintf(buf,
+ 		    "You must take at least %d points of skills and groups",
+ 		    40 + pc_race_table[ch->race].points);
+ 		send_to_char(buf, ch);
+ 		break;
+ 	    }
+ 
  	    sprintf(buf,"Creation points: %d\n\r",ch->pcdata->points);
  	    send_to_char(buf,ch);
  	    sprintf(buf,"Experience per level: %d\n\r",
***************
*** 2319,2326 ****
  void page_to_char( const char *txt, CHAR_DATA *ch )
  {
      if ( txt == NULL || ch->desc == NULL)
  
- 
      if (ch->lines == 0 )
      {
  	send_to_char(txt,ch);
--- 2339,2346 ----
  void page_to_char( const char *txt, CHAR_DATA *ch )
  {
      if ( txt == NULL || ch->desc == NULL)
+ 	return;
  
      if (ch->lines == 0 )
      {
  	send_to_char(txt,ch);
diff -b -w -c -r Rom24old/src/const.c Rom24/src/const.c
*** Rom24old/src/const.c	Thu Jul 18 04:43:40 1996
--- Rom24/src/const.c	Sat May 23 15:27:14 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/db.c Rom24/src/db.c
*** Rom24old/src/db.c	Thu Jul 18 04:43:43 1996
--- Rom24/src/db.c	Sat May 23 15:27:17 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/db.h Rom24/src/db.h
*** Rom24old/src/db.h	Thu Jul 18 04:44:46 1996
--- Rom24/src/db.h	Sat May 23 15:27:21 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/db2.c Rom24/src/db2.c
*** Rom24old/src/db2.c	Thu Jul 18 04:43:47 1996
--- Rom24/src/db2.c	Sat May 23 15:27:26 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/effects.c Rom24/src/effects.c
*** Rom24old/src/effects.c	Thu Jul 18 04:43:53 1996
--- Rom24/src/effects.c	Sat May 23 15:27:27 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/fight.c Rom24/src/fight.c
*** Rom24old/src/fight.c	Thu Jul 18 04:43:57 1996
--- Rom24/src/fight.c	Sat May 23 15:27:33 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/flags.c Rom24/src/flags.c
*** Rom24old/src/flags.c	Thu Jul 18 04:44:00 1996
--- Rom24/src/flags.c	Sat May 23 15:27:35 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/handler.c Rom24/src/handler.c
*** Rom24old/src/handler.c	Fri Jul 19 16:58:35 1996
--- Rom24/src/handler.c	Sat May 23 15:27:39 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 2514,2520 ****
      if ( IS_OBJ_STAT(obj,ITEM_GLOW))
  	return TRUE;
  
!     if ( room_is_dark( ch->in_room ) && !IS_AFFECTED(ch, AFF_INFRARED) )
  	return FALSE;
  
      return TRUE;
--- 2514,2520 ----
      if ( IS_OBJ_STAT(obj,ITEM_GLOW))
  	return TRUE;
  
!     if ( room_is_dark( ch->in_room ) && !IS_AFFECTED(ch, AFF_DARK_VISION) )
  	return FALSE;
  
      return TRUE;
diff -b -w -c -r Rom24old/src/healer.c Rom24/src/healer.c
*** Rom24old/src/healer.c	Thu Jul 18 04:44:06 1996
--- Rom24/src/healer.c	Sat May 23 15:27:39 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/interp.c Rom24/src/interp.c
*** Rom24old/src/interp.c	Thu Jul 18 04:44:10 1996
--- Rom24/src/interp.c	Sat May 23 15:27:40 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/interp.h Rom24/src/interp.h
*** Rom24old/src/interp.h	Thu Jul 18 04:44:49 1996
--- Rom24/src/interp.h	Sat May 23 15:27:41 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/lookup.c Rom24/src/lookup.c
*** Rom24old/src/lookup.c	Thu Jul 18 04:44:13 1996
--- Rom24/src/lookup.c	Sat May 23 15:27:42 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/lookup.h Rom24/src/lookup.h
*** Rom24old/src/lookup.h	Thu Jul 18 04:44:52 1996
--- Rom24/src/lookup.h	Sat May 23 15:27:43 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/magic.c Rom24/src/magic.c
*** Rom24old/src/magic.c	Thu Jul 18 04:44:17 1996
--- Rom24/src/magic.c	Sat May 23 15:27:47 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/magic.h Rom24/src/magic.h
*** Rom24old/src/magic.h	Thu Jul 18 04:44:55 1996
--- Rom24/src/magic.h	Sat May 23 15:27:47 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/magic2.c Rom24/src/magic2.c
*** Rom24old/src/magic2.c	Thu Jul 18 04:44:19 1996
--- Rom24/src/magic2.c	Sat May 23 15:27:48 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/merc.h Rom24/src/merc.h
*** Rom24old/src/merc.h	Thu Jul 18 04:44:58 1996
--- Rom24/src/merc.h	Sat May 23 15:27:51 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 1989,1995 ****
  #if	defined(SYSV)
  siz_t	fread		args( ( void *ptr, size_t size, size_t n, 
  			    FILE *stream) );
! #else
  int	fread		args( ( void *ptr, int size, int n, FILE *stream ) );
  #endif
  int	fseek		args( ( FILE *stream, long offset, int ptrname ) );
--- 1989,1995 ----
  #if	defined(SYSV)
  siz_t	fread		args( ( void *ptr, size_t size, size_t n, 
  			    FILE *stream) );
! #elif !defined(__SVR4)
  int	fread		args( ( void *ptr, int size, int n, FILE *stream ) );
  #endif
  int	fseek		args( ( FILE *stream, long offset, int ptrname ) );
diff -b -w -c -r Rom24old/src/music.c Rom24/src/music.c
*** Rom24old/src/music.c	Thu Jul 18 04:44:22 1996
--- Rom24/src/music.c	Sat May 23 15:27:51 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/music.h Rom24/src/music.h
*** Rom24old/src/music.h	Thu Jul 18 04:45:00 1996
--- Rom24/src/music.h	Sat May 23 15:27:53 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/note.c Rom24/src/note.c
*** Rom24old/src/note.c	Thu Jul 18 04:44:25 1996
--- Rom24/src/note.c	Sat May 23 15:27:54 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/recycle.c Rom24/src/recycle.c
*** Rom24old/src/recycle.c	Thu Jul 18 04:44:27 1996
--- Rom24/src/recycle.c	Sat May 23 15:27:55 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 370,377 ****
      free_string(ch->description);
      free_string(ch->prompt);
      free_string(ch->prefix);
! 
!     if (ch->pcdata != NULL)
      	free_pcdata(ch->pcdata);
  
      ch->next = char_free;
--- 370,376 ----
      free_string(ch->description);
      free_string(ch->prompt);
      free_string(ch->prefix);
!     free_note  (ch->pnote);
      free_pcdata(ch->pcdata);
  
      ch->next = char_free;
diff -b -w -c -r Rom24old/src/recycle.h Rom24/src/recycle.h
*** Rom24old/src/recycle.h	Thu Jul 18 04:45:03 1996
--- Rom24/src/recycle.h	Sat May 23 15:27:56 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/save.c Rom24/src/save.c
*** Rom24old/src/save.c	Thu Jul 18 04:44:30 1996
--- Rom24/src/save.c	Sat May 23 15:27:58 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/scan.c Rom24/src/scan.c
*** Rom24old/src/scan.c	Thu Jul 18 04:44:33 1996
--- Rom24/src/scan.c	Sat May 23 15:27:58 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/skills.c Rom24/src/skills.c
*** Rom24old/src/skills.c	Thu Jul 18 04:44:36 1996
--- Rom24/src/skills.c	Sat May 23 15:28:00 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 709,714 ****
--- 709,723 ----
  	 	return TRUE;
  	    }
  
+ 	    /* Close security hole */
+ 	    if (ch->gen_data->points_chosen + group_table[gn].rating[ch->class]
+ 		> 300)
+ 	    {
+ 		send_to_char(
+ 		    "You cannot take more than 300 creation points.\n\r", ch);
+ 		return TRUE;
+ 	    }
+ 
  	    sprintf(buf,"%s group added\n\r",group_table[gn].name);
  	    send_to_char(buf,ch);
  	    ch->gen_data->group_chosen[gn] = TRUE;
***************
*** 734,739 ****
--- 743,757 ----
  		send_to_char("That skill is not available.\n\r",ch);
  		return TRUE;
  	    }
+ 
+ 	    /* Close security hole */
+ 	    if (ch->gen_data->points_chosen + skill_table[sn].rating[ch->class]
+ 		> 300)
+ 	    {
+ 		send_to_char(
+ 		    "You cannot take more than 300 creation points.\n\r", ch);
+ 		return TRUE;
+ 	    }
  	    sprintf(buf, "%s skill added\n\r",skill_table[sn].name);
  	    send_to_char(buf,ch);
  	    ch->gen_data->skill_chosen[sn] = TRUE;
diff -b -w -c -r Rom24old/src/special.c Rom24/src/special.c
*** Rom24old/src/special.c	Thu Jul 18 04:44:38 1996
--- Rom24/src/special.c	Sat May 23 15:28:01 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/tables.c Rom24/src/tables.c
*** Rom24old/src/tables.c	Thu Jul 18 04:44:41 1996
--- Rom24/src/tables.c	Sat May 23 15:28:04 1998
***************
*** 16,25 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
diff -b -w -c -r Rom24old/src/tables.h Rom24/src/tables.h
*** Rom24old/src/tables.h	Thu Jul 18 04:45:06 1996
--- Rom24/src/tables.h	Sat May 23 15:28:05 1998
***************
*** 16,26 ****
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
  *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
! *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
  ***************************************************************************/
--- 16,26 ----
   ***************************************************************************/
   
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
  *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
  ***************************************************************************/
diff -b -w -c -r Rom24old/src/update.c Rom24/src/update.c
*** Rom24old/src/update.c	Thu Jul 18 04:44:44 1996
--- Rom24/src/update.c	Sat May 23 15:28:06 1998
***************
*** 16,25 ****
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1996 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@efn.org)				   *
! *	    Gabrielle Taylor						   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
--- 16,25 ----
   ***************************************************************************/
  
  /***************************************************************************
! *	ROM 2.4 is copyright 1993-1998 Russ Taylor			   *
  *	ROM has been brought to you by the ROM consortium		   *
! *	    Russ Taylor (rtaylor@hypercube.org)				   *
! *	    Gabrielle Taylor (gtaylor@hypercube.org)			   *
  *	    Brian Moore (zump@rom.org)					   *
  *	By using this code, you have agreed to follow the terms of the	   *
  *	ROM license, in the file Rom24/doc/rom.license			   *
***************
*** 748,754 ****
              int dam;
  
  	    if (ch->in_room == NULL)
! 		return;
              
  	    act("$n writhes in agony as plague sores erupt from $s skin.",
  		ch,NULL,NULL,TO_ROOM);
--- 748,754 ----
              int dam;
  
  	    if (ch->in_room == NULL)
! 		continue;
              
  	    act("$n writhes in agony as plague sores erupt from $s skin.",
  		ch,NULL,NULL,TO_ROOM);
***************
*** 762,772 ****
              if (af == NULL)
              {
              	REMOVE_BIT(ch->affected_by,AFF_PLAGUE);
!             	return;
              }
          
              if (af->level == 1)
!             	return;
          
  	    plague.where		= TO_AFFECTS;
              plague.type 		= gsn_plague;
--- 762,772 ----
              if (af == NULL)
              {
              	REMOVE_BIT(ch->affected_by,AFF_PLAGUE);
!             	continue;
              }
          
              if (af->level == 1)
!             	continue;
          
  	    plague.where		= TO_AFFECTS;
              plague.type 		= gsn_plague;